# Release Notes: Version 4.5.5 - 4.5.2-beta.3 (September 30 - September 5, 2025)

## Bug Fixes

- Fixed an issue where the comment dialog would auto-close after submitting the first comment in popover mode.
- Fixed an issue where `resolvedCommentsOnDom` was not applying to comment bubbles in the video player timeline.
- Fixed an issue where inline comments section filter dropdown wireframe not rendering correctly.
- Fixed an issue where the recording edit done event was not triggering with the correct data.
- Fixed an issue where the countdown timer for the recorder was not working in Firefox.
- Fixed an issue where floating mode prop was being incorrectly added in React when enabling embed mode in the sidebar.
- Fixed an issue where the Recorder control panel not being draggable.
- Fixed an issue where Get User Permissions REST API was not returning `permission_denied` errors in the response.
- Fixed an issue where clicking on one comment bubble would unintentionally open multiple comment bubbles. Now clicking on a comment bubble correctly opens only that specific bubble.
- Fixed an issue where empty comments were being saved in some scenarios.
- Fixed a minor issue with the `fullScreen` prop in the Comments Sidebar.
- Fixed Firefox compatibility issue that was preventing recordings from being stopped properly.
- Fixed an issue where Notification Panel was not closing if Velt was not initialized.
- Fixed invalid user name validation to now accept email values in user names. Also improved URL handling by removing content after the last dot (.) to make URLs non-functional, and increased maximum character limit from 20 to 30.
- Fixed document switch issue where comments were not properly disappearing when navigating between documents, ensuring clean state transitions.
- Fixed local cache comment persistence issue that was causing stale comment data to remain after document changes.
- Fixed heartbeat handling issue when external heartbeat is passed to prevent conflicts with internal presence detection mechanisms.
- Fixed Angular Material CSS scoping to prevent style conflicts by ensuring Angular Material styles are properly contained within Velt components.
- Fixed issue where editor assignment process wasn't reinitiated when a user regained internet connection or became active again after being offline. This ensures proper editor role management in collaborative editing scenarios.
- Fixed "Edit here" functionality to properly assign editor role to users even when no existing data is available in the document.
- Fixed React hook `setDocumentSuccess` event that wasn't triggering properly by adding flush sync method for `initUpdate` events. This ensures proper event handling and state updates in React applications.
- Fixed Recording Preview Dialog width issue.
- In `InlineCommentsSection` single-thread mode, count now reflects the number of Comments vs Comment Annotations.
- Fixed an issue where longer recordings were not rendering the preview correctly in recording player and editor.
- Fixed an issue where the host app was not clickable when screen recording was used in floating mode.
- Fixed `recorderId` change detection in video player.
- Fixed thread mode UI for screen recordings.

## Improvements

- Added option to close persistent comment mode with ESC key, even when a thread is active. Use `forceCloseAllOnEsc` (prop/API).
- Added ability to hide notification tabs when only one tab is enabled.
- Improved CSS variable handling in the ESC button for Persistent Comments Banner.
- Removed extra space next to the notification icon.
- Updated Get User Permissions API to remove `userIds` from the request payload and now returns structured error codes alongside permission denied messages. This provides clearer error handling and makes it easier to diagnose permission issues programmatically.
- Users with Viewer access can no longer add comments or update metadata through the SDK. This ensures proper permission enforcement on Velt features.
- Added additional debugging logs for Single Editor Mode.
- Removed translation from group name in sidebar to allow special characters.
- Added validations in `setUserAsEditor` to set a user only if no editor is currently assigned.
- Optimized and made Single Editor Mode more robust.

## New Features

### Comments

- Added attachments data support in REST API endpoints for adding and updating comments. You can programmatically include attachment metadata when creating or modifying comments through the REST API. The `attachments` field supports comprehensive metadata including: file identification (`attachmentId`, `name`, `bucketPath`), file properties (`size`, `type`, `url`, `thumbnail`, `mimeType`), and custom metadata (flexible metadata object for dimensions, timestamps, and other custom properties).
- Added hide reply button wireframe for the comment dialog.
- Added thread card reply button wireframe for the comment dialog to enable quick replies directly from comment thread cards.
- Added filter dropdown wireframe for the inline comments section.
- Added `allowedFileTypes` property to limit file types in comment attachments.
- Added ability to display the attachment filename in the message when a file is attached.
- Added setComposerFileAttachments() API method to programmatically add file attachments to the comment composer from your application instead of requiring users to select files from the file system.
- Added comment-level reply button wireframe. This button is hidden by default and can be enabled through wireframe customization.
- Added hide reply button wireframes for the comment dialog body.
- Added `readOnly` flag to Comment Bubble component to prevent users from replying or editing existing comments in the target bubble while still displaying them. This is useful when you want to display comments in a read-only mode where users can view but not modify or respond to comments.
- Added `disabled` flag to Comment Tool component to disable the comment tool and prevent users from adding new comments. This is helpful when you want to temporarily or conditionally restrict comment creation while still allowing users to view existing comments.
- Added full-screen mode for Comments Sidebar to maximize space for reviewing and managing comments. This is particularly useful when working with large volumes of feedback or conducting detailed comment reviews. By default, this feature is disabled and only supported in default mode (floating and embed modes are not supported).
- Added fixed annotation numbers to comment pins and dialogs that persist across sessions, making it easier to reference specific comments in discussions and documentation. This replaces the previous temporary numbering system that reset on page refresh.
- Added search by annotation number in Comments Sidebar. You can now quickly find specific comments by typing their annotation number (e.g., `#2`) in the search field, making it faster to locate and navigate to referenced comments.
- Added `commentPlaceholder` and `replyPlaceholder` props on `VeltComments` so you can tailor input copy to your app's voice and improve guidance for first-time users.
- Updated default placeholders and added props to customize placeholders for comment and reply inputs. Added wireframes to allow users to customize how it looks. Default placeholders: Comment: "Comment or add others with @", Reply: "Reply or add others with @"
- Added hook to set and get UI state.
- Added Edited chip in comment thread: Edits are now visibly transparent at a glance, improving auditability and helping reviewers quickly spot updated messages in long discussions.
- Added clickable links of text selection in comments and a link callback to handle link clicks programmatically.
- Slack-style link pasting: select text and paste a link to directly convert it into a clickable hyperlink. This speeds up authoring and provides a familiar UX for users.
- Added group support for custom lists. Useful for workflows like issue trackers (e.g., group by "Priority" or "Status"), allowing users to quickly refer and insert custom entities from your app. With this feature, you can combine multiple entity types into one drop down just like Linear.

### Notifications

- Added ESC key support to close the notification panel.
- Added `considerAllNotifications` configuration to the notifications tool to control the notification count and unread indicator. When enabled, the notification count and unread badge include items from all tabs; when disabled (default), they only include items from the "For You" tab.
- Added ability to filter notifications to the currently set document only. By default it shows notifications for the 15 most recently active documents accessible to the current user in the current organization.

### Recorder

- Added unread badge in CommentPlayerTimeline for annotations.
- Added configuration to control playback behavior on preview click. You can now enable or disable the click-to-play/pause functionality on recording previews.
- Added `recorderId` prop to Video Editor.
- Added maximum recording length feature that allows you to set time limits on recordings. This helps manage storage costs and ensures recordings stay focused and relevant.
- Added Picture-in-Picture (PiP) mode for screen recordings when camera is enabled. This allows users to continue recording while multitasking, improving workflow efficiency for tutorial creation and documentation. Picture-in-Picture is only supported in Chrome browsers and only works for screen recordings when the camera is active. This feature is disabled by default.
- Added screen recording preview to let users see their screen recordings preview prior to staring the recording. This helps users make make necessary adjustments before starting the recording. You programmatically ask users for permissions using the new API.

### Access Control

- Added User Permissions API to fetch a user's `editor`/`viewer` access across organizations, folders, and documents, for both permanent and temporary users. This helps you enforce read-only experiences. Users with `viewer` access are read-only; write actions like adding comments are blocked in the SDK.
- Added support for viewer and editor roles for permanent and temporary users. Editor: Full read/write access to collaboration data on the resource (create/edit/delete comments and replies, add reactions, start recordings, etc.). Viewer: Read-only access to collaboration data (view comments and replies, presence, cursors, recordings, notifications) without the ability to modify. Why this matters: You can enforce read-only experiences, safely grant temporary edit windows, and align Velt features with your app's permission model.

### Single Editor Mode

- Added `updateUserPresence` to send heartbeat data from the host app. This helps Velt detect multi-tab activity and resolve who is the active editor when users switch tabs or devices and will use that as a fallback in rare edge cases if it fails to detect multi‑tab/device presence. Most apps don't need this; use only if you see ambiguity in who's the active editor.

## UI Customization

- Added new wireframes to customize the appearance of comment annotation numbers and full-screen button in the Comments Sidebar: Comment Dialog Number Wireframe, Comment Pin Number Wireframe, Comments Sidebar Full-Screen Button Wireframe.
- Scoped `.cdk-overlay-pane` CSS into `.velt-overlay-panel` class to avoid global style leakage.
