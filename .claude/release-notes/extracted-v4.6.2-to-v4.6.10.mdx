Version Range: v4.6.2 to v4.6.10

## New Features

- [**Comments**]: Added mark as read/unread option in comment dialog. You can now toggle read status for individual comments. [See wireframe customization →](/ui-customization/features/async/comments/comment-dialog-components#optionscontentmarkasread)

- [**Comments**]: Added `unread` property to annotations. You can now check if an annotation is unread by the current user. See [`CommentAnnotation` data model](/api-reference/sdk/models/data-models#commentannotation).

- [**Comments**]: Added Open and Reset filters to sidebar minimal filter dropdown. Filter annotations by open status or clear all active filters. [See wireframe customization →](/ui-customization/features/async/comments/comment-sidebar-components#minimalfilterdropdowncontent)

- [**Comments**]: Added `context` prop to comment sidebar. Pass context data to page mode composer comments.

- [**CRDT**]: Added webhook support for CRDT data changes. Webhooks are disabled by default. When enabled, the default debounce time is 5 seconds. Control webhook behavior using `enableWebhook()`, `disableWebhook()`, and `setWebhookDebounceTime()` methods. [See documentation →](/realtime-collaboration/crdt/setup/core#webhooks)

- [**CRDT**]: Added `updateData` event subscription to listen for CRDT data changes. Subscribe using the `on()` method to receive real-time notifications when CRDT data is modified. [See documentation →](/realtime-collaboration/crdt/setup/core#on)

- [**Live Selection**]: Added `setInactivityTime()` to configure inactivity duration before removing stale live selections. Default is 5 minutes.

- [**Comments**]: Added `commentCountType` prop to control which count displays in sidebar buttons. Choose between total or unread comment counts.

- [**Comments**]: Added `openDialog` prop to comment bubbles. Set to `false` to prevent dialog from opening when bubble is clicked.

- [**Comments**]: Added `commentBubbleClickedEvent` to detect comment bubble interactions.

- [**UI Customization**]: Added unread icon wireframes to sidebar buttons and comment bubbles. Display custom unread indicators for unread comments. [See sidebar button wireframes →](/ui-customization/features/async/comments/comment-sidebar-button#unreadicon) [See comment bubble wireframes →](/ui-customization/features/async/comments/comment-bubble#unreadicon)

- [**Core**]: Added `getCurrentUserPermissions` API to subscribe to current user permissions. Useful for debugging and developer tools integration.

## Improvements

- [**Comments**]: Added `velt-comment-dialog--read-only` class to comment dialogs. Style read-only comment dialogs with custom CSS.

- [**Comments**]: Added `velt-comment-sidebar-minimal-filter-content-item--selected` class to selected filter items. Style selected filter items in sidebar minimal view.

- [**Comments**]: Minimal actions and filter dropdowns now close automatically when an item is selected.

- [**Access Control**]: Added context information to permission provider requests when `setDocuments` is called. The context set during `setDocuments` is now included in resource access requests.

- [**Access Control**]: Added context access information to `getUserPermissions` API response. Returns `accessFields` array showing which context values the user has access to.

- [**Comments**]: Added paginated contact list to limit user downloads. Significantly reduces data transfer for apps with thousands of users.

- [**Comments**]: Improved robust XPath detection logic when resolving elements through comment anchors. Anchoring now supports more scenarios for detecting target elements when adding comments.

- [**Core**]: Added context access info to `getUserPermissions` and `getCurrentUserPermissions` APIs for enhanced debugging capabilities.

- [**Core**]: Added context field from `setDocuments` to `fetchDebugInfo` method for improved debugging support.

- [**Core**]: Added batching for internal service calls. Reduces network calls by 90%.

- [**Comments**]: Refactored `@veltdev/tiptap-velt-comments` and `@veltdev/lexical-velt-comments` to follow a common pattern and folder structure across all libraries. This enables faster development of Velt comment integrations and covers more rich text editor scenarios.

- [**Comments**]: Added `expandOnSelection` prop to Comments Sidebar. Control whether dialogs expand when selected in the sidebar.

- [**Comments**]: Added event subscription support for data providers via the `Velt.on` method. You can now monitor and debug data provider operations (get, save, delete) using the same event-based debugging pattern available for permission providers.

- [**Comments**]: Reply counts now display in read-only mode. Previously hidden, you can now see the number of replies on each comment when viewing in read-only state.

- [**Comments**]: Added `dialogSelection` prop to disable dialog selection in sidebar. Control whether users can select comment dialogs in the sidebar.

- [**Core**]: Added `throwError` config to `identify()` and auth provider methods. Set `throwError: true` to receive errors instead of null when authentication fails. Default is `false`.

- [**Core**]: Improved `updateContext()` logic to handle context access scenarios. Context resolution now works correctly regardless of merge settings.

## Bug Fixes

- [**Comments**]: Fixed sidebar button showing "..." instead of "0" when document has no comments. Unread count now displays correctly.

- [**Core**]: Fixed document metadata not being saved during `setDocuments`. Metadata details are now correctly persisted to the database.

- [**Comments**]: Fixed shadow DOM error in Comment Player Timeline where a variable was accessing an undefined component instance.

- [**Comments**]: Fixed `data-velt-comment-pin-active` attribute being incorrectly removed when a dialog was still selected in the host element. The attribute now correctly reflects the active state across all annotations in the host.

- [**Comments**]: Fixed reset filter in multi-thread comments not showing resolved comments. The reset button now clears all filters and displays all annotations including resolved ones.

- [**Comments**]: Fixed race condition in `addContext` where user context was being overwritten. Added internal timeout to ensure user context is properly applied alongside the default access context.

- [**Comments**]: Fixed Comment Bubble closing unexpectedly after adding the first comment. The bubble now remains open as expected.

- [**Comments**]: Fixed draft comment annotations not being created. Users can now add draft comment annotations again.

- [**Comments**]: Fixed `contextId` generation in comment annotations. Context filtering now works correctly with exact matches in Comment Tool and Comment Bubble components.

- [**Comments**]: Added pin click event support for Standalone Comment Pin Component (VeltCommentPin). Click events now work consistently across all pin types.
