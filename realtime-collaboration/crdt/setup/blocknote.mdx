---
title: BlockNote Editor
description: Setup Multiplayer Editing for BlockNote Editor.
---

The `@veltdev/blocknote-crdt-react` library enables real-time collaborative editing on BlockNote Editors. The collaboration editing engine is built on top of [Yjs](https://docs.yjs.dev/) and Velt SDK.

## Prerequisites

- Node.js (v14 or higher)
- React (v16.8 or higher for hooks)
- A Velt account with an API key ([sign up](https://console.velt.dev/))
- Optional: TypeScript for type safety

## Setup

### Step 1: Install Dependencies

Install the required packages:

<Tabs>
  <Tab title="React">
    ```bash
    npm install @veltdev/blocknote-crdt-react
    ```
  </Tab>
  <Tab title="Other Frameworks">
    ```txt
    Docs coming soon
    ```
  </Tab>
</Tabs>

### Step 2: Setup Velt

Initialize the Velt client by following the [Velt Setup Docs](/get-started/quickstart). This is required for the collaboration engine to work.


### Step 3: Initialize Velt CRDT Extension

- Initialize the Velt CRDT extension and use it to initialize the BlockNote editor.
- Pass an `editorId` to uniquely identify each editor instance you have in your app. This is especially important when you have multiple editors in your app.


<Tabs>
<Tab title="React">

```jsx
const { collaborationConfig } = useVeltBlockNoteCrdtExtension({
  editorId: 'YOUR_EDITOR_ID',
  initialContent: JSON.stringify([{ type: "paragraph", content: "" }])
});

const editor = useCreateBlockNote({
  collaboration: collaborationConfig,
}, [collaborationConfig]);

return (
  <BlockNoteView
    editor={editor}
    key={collaborationConfig ? 'collab-on' : 'collab-off'}
  />
);
```

</Tab>
<Tab title="Other Frameworks">

```txt
Docs coming soon
```

</Tab>
</Tabs>

## Notes

- **Unique editorId**: Use a unique `editorId` per editor instance.
- **Pass collaborationConfig**: Provide an `editor` and key with collaborationConfig to BlockNote.

## Testing and Debugging

**To test collaboration:**
1. Login two unique users on two browser profiles and open the same page in both.
2. Edit in one window and verify changes and cursors appear in the other.

**Common issues:**
- Cursors not appearing: Ensure each editor has a unique `editorId` and users are authenticated. Also ensure that you are logged in with two different users in two different browser profiles.
- Editor not loading: Confirm the Velt client is initialized and the API key is valid.

## Complete Example

<Tabs>
<Tab title="Complete Code">

See [Velt BlockNote Demo Repo](https://github.com/velt-js/velt-blocknote-crdt-demo) for our complete implementation.


```jsx Relevant Code expandable lines
import '@blocknote/core/fonts/inter.css';
import { BlockNoteView } from "@blocknote/mantine";
import '@blocknote/mantine/style.css';
import { useCreateBlockNote } from "@blocknote/react";
import { useVeltBlockNoteCrdtExtension } from "@veltdev/blocknote-crdt-react";
import React from "react";

const BlockNoteCollaborativeEditor: React.FC = () => {

  const { collaborationConfig, isLoading } = useVeltBlockNoteCrdtExtension({
    editorId: 'YOUR_EDITOR_ID',
    initialContent: JSON.stringify([{ type: "paragraph", content: "" }])
  });

  // Now call the hook at top level with the config
  const editor = useCreateBlockNote({
    collaboration: collaborationConfig,
    // Add any other static options here
  }, [collaborationConfig]); // Deps ensure re-init if config changes

  return (
    <>
      <div className="editor-container">
        <div className="editor-content">
          <BlockNoteView editor={editor} key={collaborationConfig ? 'collab-on' : 'collab-off'} />
        </div>
        <div className="status">
          {!isLoading ? 'Connected to collaborative session' : 'Connecting to collaborative session...'}
        </div>
      </div>
    </>
  );
};

export default BlockNoteCollaborativeEditor;
```

</Tab>
<Tab title="Live Demo">

[Open in larger window](https://velt-blocknote-crdt-demo.vercel.app/)

<Frame>
  <iframe
    src="https://velt-blocknote-crdt-demo.vercel.app/"
    className="w-full"
    height="500px"
  ></iframe>
</Frame>


</Tab>
</Tabs>

## APIs

### Custom Encryption

You can encrypt CRDT data before it’s stored in Velt by registering a custom encryption provider. For CRDT methods, input data is of type `Uint8Array | number[]`.

<Tabs>
<Tab title="React / Next.js">

```ts
async function encryptData(config: EncryptConfig<number[]>): Promise<string> {
  const encryptedData = await yourEncryptDataMethod(config.data);
  return encryptedData;
}

async function decryptData(config: DecryptConfig<string>): Promise<number[]> {
  const decryptedData = await yourDecryptDataMethod(config.data);
  return decryptedData;
}

const encryptionProvider: VeltEncryptionProvider<number[], string> = {
  encrypt: encryptData,
  decrypt: decryptData,
};

<VeltProvider
  apiKey="YOUR_API_KEY"
  encryptionProvider={encryptionProvider}
/>

```

</Tab>
<Tab title="Other Frameworks">

```ts
async function encryptData(config: EncryptConfig<number[]>): Promise<string> {
  const encryptedData = await yourEncryptDataMethod(config.data);
  return encryptedData;
}

async function decryptData(config: DecryptConfig<string>): Promise<number[]> {
  const decryptedData = await yourDecryptDataMethod(config.data);
  return decryptedData;
}

const encryptionProvider: VeltEncryptionProvider<number[], string> = {
  encrypt: encryptData,
  decrypt: decryptData,
};

client.setEncryptionProvider(encryptionProvider);
```

</Tab>
</Tabs>

See also: [setEncryptionProvider()](/api-reference/sdk/api/api-methods#setencryptionprovider-encryptionprovider)
 · [VeltEncryptionProvider](/api-reference/sdk/models/data-models#veltencryptionprovider)
 · [EncryptConfig](/api-reference/sdk/models/data-models#encryptconfig)
 · [DecryptConfig](/api-reference/sdk/models/data-models#decryptconfig)


### [useVeltBlockNoteCrdtExtension()](/api-reference/sdk/api/api-methods#useveltblocknotecrdtextension)
Provides real-time collaborative BlockNote editor functionality with Yjs and Velt SDK synchronization.

- Signature: useVeltBlockNoteCrdtExtension(config: VeltBlockNoteCrdtExtensionConfig)
- Params: [VeltBlockNoteCrdtExtensionConfig](/api-reference/sdk/models/data-models#veltblocknotecrdtextensionconfig)
  - `editorId`: Unique identifier for the editor instance.
  - `initialContent`: Initial content for the editor.
  - `debounceMs`: Debounce time for update propagation (ms).
- Returns: [VeltBlockNoteCrdtExtensionResponse](/api-reference/sdk/models/data-models#veltblocknotecrdtextensionresponse)
  - `collaborationConfig`: Configuration object to pass into BlockNote.
  - `store`: BlockNote CRDT store instance.
  - `isLoading`: Whether the store is initialized. `false` once store is initialized, `true` by default.


### Store Methods

#### [store.getStore()](/api-reference/sdk/api/api-methods#getstore)

Access the underlying CRDT store managing document state.

- Returns: Store

```js
const crdtStore = store.getStore();
```

#### [store.destroy()](/api-reference/sdk/api/api-methods#destroy)

Tear down the store and clean up listeners/resources.

- Returns: void

```js
store.destroy();
```

#### [store.getYDoc()](/api-reference/sdk/api/api-methods#getydoc)

Accessor for the underlying Yjs document.

- Returns: Y.Doc

```jsx
const ydoc = store.getYDoc();
```


#### [store.getYXml()](/api-reference/sdk/api/api-methods#getyxml)

Returns the Y.XmlFragment instance that handles Tiptap's rich text structure.

- Returns: Y.XmlFragment | null

```jsx
const yxml = store.getYXml();
``` 
{/* Store-related methods below are for manual store management and not needed when using the React hook */}

{/*
#### [createVeltBlockNoteStore](/api-reference/sdk/api/api-methods#createveltblocknotestore)

Create and initialize a collaborative BlockNote store instance.

- Params: [VeltBlockNoteStoreConfig](/api-reference/sdk/models/data-models#veltblocknotestoreconfig)
- Returns: VeltBlockNoteStore | null

<Tabs>
<Tab title="React / Next.js">
```jsx
const store = await createVeltBlockNoteStore({ editorId: 'my-collaborative-editor' });
```
</Tab>

<Tab title="Other Frameworks">
```js
const store = await createVeltBlockNoteStore({ editorId: 'my-collaborative-editor' });
```
</Tab>
</Tabs>

#### [initialize()](/api-reference/sdk/api/api-methods#initialize)

Initialize the store and start syncing the collaborative document.

- Returns: void

<Tabs>
<Tab title="React / Next.js">
```jsx
await store.initialize();
```
</Tab>

<Tab title="Other Frameworks">
```js
await store.initialize();
```
</Tab>
</Tabs>

#### [destroy()](/api-reference/sdk/api/api-methods#destroy)

Tear down the store and clean up listeners/resources.

- Returns: void

<Tabs>
<Tab title="React / Next.js">
```jsx
store.destroy();
```
</Tab>

<Tab title="Other Frameworks">
```js
store.destroy();
```
</Tab>
</Tabs>

#### [getStore()](/api-reference/sdk/api/api-methods#getstore)

Access the underlying CRDT store managing document state.

- Returns: Store

<Tabs>
<Tab title="React / Next.js">
```jsx
const crdtStore = store.getStore();
```
</Tab>

<Tab title="Other Frameworks">
```js
const crdtStore = store.getStore();
```
</Tab>
</Tabs>

#### [getYDoc()](/api-reference/sdk/api/api-methods#getydoc)

Accessor for the underlying Yjs document.

- Returns: Y.Doc

```jsx
const ydoc = store.getYDoc();
```

#### [getYXml()](/api-reference/sdk/api/api-methods#getyxml)

Returns the Y.XmlFragment instance that handles BlockNote's rich text structure.

- Returns: Y.XmlFragment | null

```jsx
const yxml = store.getYXml();
```
*/}
