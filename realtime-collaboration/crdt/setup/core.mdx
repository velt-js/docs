---
title: Core
description: Setup CRDT for any framework.
---

## Introduction

Use these guides to add Yjs-based CRDT to your project with Velt. Pick the React Hook wrapper for the fastest integration in React apps, or the core library for other frameworks and vanilla setups.

## Setup

### Step 1: Install Dependencies

<Tabs>
<Tab title="React Hook Wrapper (@veltdev/crdt-react)">

**npm:**
```bash
npm install @veltdev/crdt-react @veltdev/crdt @veltdev/react
```

**yarn:**
```bash
yarn add @veltdev/crdt-react @veltdev/crdt @veltdev/react
```

</Tab>
<Tab title="Other Frameworks (@veltdev/crdt)">

**npm:**
```bash
npm install @veltdev/crdt @veltdev/client
```

**yarn:**
```bash
yarn add @veltdev/crdt @veltdev/client
```

</Tab>
</Tabs>

### Step 2: Initialize Velt in your app

Wrap your app with `VeltProvider` or initialize the client. See [Install Docs](/get-started/setup/install).

<Tabs>
<Tab title="React Hook Wrapper (@veltdev/crdt-react)">

```jsx
import { VeltProvider } from '@veltdev/react';

export function Root() {
  return (
    <VeltProvider apiKey="YOUR_API_KEY">
      <App />
    </VeltProvider>
  );
}
```

</Tab>
<Tab title="Other Frameworks (@veltdev/crdt)">

```ts
import { initVelt } from '@veltdev/client';

// Initialize once in your app bootstrap
export const client = await initVelt('YOUR_API_KEY');
```

</Tab>
</Tabs>

### Step 3: Create a CRDT store

<Tabs>
<Tab title="React Hook Wrapper (@veltdev/crdt-react)">

Create a `text` store with the React hook.

```jsx
import { useVeltCrdtStore } from '@veltdev/crdt-react';

function Component() {
  const { store } = useVeltCrdtStore<string>({
    id: 'my-collab-note',
    type: 'text',
    initialValue: 'Hello, world!',
  });
  return null;
}
```

</Tab>
<Tab title="Other Frameworks (@veltdev/crdt)">

Create a `text` store with the core library.

```ts
import { createVeltStore } from '@veltdev/crdt';
import { initVelt } from '@veltdev/client';

const veltClient = await initVelt('YOUR_API_KEY');

const store = await createVeltStore<string>({
  id: 'my-document',
  type: 'text', // 'array' | 'map' | 'text' | 'xml'
  initialValue: 'Hello, world!',
  veltClient,
});
```

</Tab>
</Tabs>

### Step 4: Listen for changes

Listen and subscribe for updates from local and remote peers.

<Tabs>
<Tab title="React Hook Wrapper (@veltdev/crdt-react)">

```jsx
import { useEffect } from 'react';
import { useVeltCrdtStore } from '@veltdev/crdt-react';

function Component() {
  const { store } = useVeltCrdtStore<string>({ id: 'my-collab-note', type: 'text' });

  useEffect(() => {
    if (!store) return;
    const unsubscribe = store.subscribe((newValue) => {
      console.log('Updated value:', newValue);
    });
    return unsubscribe;
  }, [store]);

  return null;
}
```

</Tab>
<Tab title="Other Frameworks (@veltdev/crdt)">

```ts
const unsubscribe = store.subscribe((newValue) => {
  console.log('Updated value:', newValue);
});
```

</Tab>
</Tabs>

### Step 5: Update the store value

Apply and update local changes to the store.

<Tabs>
<Tab title="React Hook Wrapper (@veltdev/crdt-react)">

```jsx
import { useVeltCrdtStore } from '@veltdev/crdt-react';

function Component() {
  const { update } = useVeltCrdtStore<string>({ id: 'my-collab-note', type: 'text' });
  const onChange = (e) => update(e.target.value);
  return <input onChange={onChange} />;
}
```

</Tab>
<Tab title="Other Frameworks (@veltdev/crdt)">

```ts
store.update('Hello, collaborative world!');
```

</Tab>
</Tabs>

### Step 6: Save and restore versions

Create checkpoints and roll back when needed.

<Tabs>
<Tab title="React Hook Wrapper (@veltdev/crdt-react)">

```jsx
import { useVeltCrdtStore } from '@veltdev/crdt-react';

function Component() {
  const { saveVersion, getVersions, getVersionById, setStateFromVersion } =
    useVeltCrdtStore<string>({ id: 'my-collab-note', type: 'text' });

  async function onSave() {
    const versionId = await saveVersion('Checkpoint');
    console.log('Saved version:', versionId);
  }

  async function onRestoreLatest() {
    const versions = await getVersions();
    if (versions.length === 0) return;
    const latest = versions[0];
    await setStateFromVersion(latest);
  }

  return (
    <div>
      <button onClick={onSave}>Save Version</button>
      <button onClick={onRestoreLatest}>Restore Latest</button>
    </div>
  );
}
```

</Tab>
<Tab title="Other Frameworks (@veltdev/crdt)">

```ts
const versionId = await store.saveVersion('Initial checkpoint');
const versions = await store.getVersions();
const fetched = await store.getVersionById(versionId);
if (fetched) {
  await store.setStateFromVersion(fetched);
}
```

</Tab>
</Tabs>

## APIs

<Tabs>
<Tab title="React Hook Wrapper (@veltdev/crdt-react)">

#### [useVeltCrdtStore](/api-reference/sdk/api/api-methods#useveltcrdtstore)

React hook to create and sync a collaborative CRDT store.

- Params: [useveltcrdtstore](/api-reference/sdk/models/data-models#useVeltCrdtStore)
- Returns: [`Store<T>`](/api-reference/sdk/models/data-models#storeconfig<t>%3B)

```jsx
const {
  value,
  versions,
  store,
  update,
  saveVersion,
  getVersions,
  getVersionById,
  restoreVersion,
  setStateFromVersion,
} = useVeltCrdtStore<string>({
  id: 'my-collab-note',
  type: 'text',
  initialValue: 'Hello, world!',
  debounceMs: 100,
});
```

#### [value](/api-reference/sdk/api/api-methods#value)

Current value of the store.

- Type: `T | null`

```jsx
console.log(value);
```

#### [versions](/api-reference/sdk/api/api-methods#versions)

List of all stored versions.

- Type: `Version[]`

```jsx
console.log(versions);
```

#### [store](/api-reference/sdk/api/api-methods#store)

Underlying Velt Store instance.

- Type: `Store<T> | null`

```jsx
console.log(store);
```

#### [restoreVersion()](/api-reference/sdk/api/api-methods#restoreversion)

Restore the store to a specific version by ID.

- Params: `versionId: string`
- Returns: `Promise<boolean>`

```jsx
await restoreVersion('abc123');
```

#### [update](/api-reference/sdk/api/api-methods#update)

Update the store value.

- Params: `newValue: T`
- Returns: `void`

```jsx
update('New value');
```

#### [saveVersion](/api-reference/sdk/api/api-methods#saveversion)

Save a snapshot of the current state as a named version.

- Params: `versionName: string`
- Returns: `Promise<string>`

```jsx
await saveVersion('Checkpoint');
```

#### [getVersions](/api-reference/sdk/api/api-methods#getversions)

Fetch all saved versions.

- Params: `none`
- Returns: `Promise<Version[]>`

```jsx
const versions = await getVersions();
```

#### [getVersionById](/api-reference/sdk/api/api-methods#getversionbyid)

Fetch a specific version by ID.

- Params: `versionId: string`
- Returns: `Promise<Version | null>`

```jsx
const version = await getVersionById('abc123');
```

#### [setStateFromVersion](/api-reference/sdk/api/api-methods#setstatefromversion)

Restore the store state from a specific version.

- Params: `version: Version`
- Returns: `Promise<void>`

```jsx
await setStateFromVersion(version);
```

</Tab>
<Tab title="Other Frameworks (@veltdev/crdt)">

#### [createVeltStore](/api-reference/sdk/api/api-methods#createveltstore)

Create and initialize a collaborative CRDT store.

- Params: [StoreConfig](/api-reference/sdk/models/data-models#storeconfig<t>%3B)
- Returns: `Promise<Store<T> | null>`

```ts
const store = await createVeltStore<string>({
  id: 'my-document',
  type: 'text',
  initialValue: 'Hello, world!',
  veltClient,
});
```

#### [getDoc](/api-reference/sdk/api/api-methods#getdoc)

Get the underlying Yjs document.

- Returns: `Y.Doc`

```ts
const ydoc = store.getDoc();
```

#### [getProvider](/api-reference/sdk/api/api-methods#getprovider)

Get the provider instance for the store.

- Returns: `Provider`

```ts
const provider = store.getProvider();
```

#### [getText](/api-reference/sdk/api/api-methods#gettext)

Get the Y.Text instance if store type is 'text'.

- Returns: `Y.Text | null`

```ts
const ytext = store.getText();
```

#### [getXml](/api-reference/sdk/api/api-methods#getxml)

Get the Y.XmlFragment instance if store type is 'xml'.

- Returns: `Y.XmlFragment | null`

```ts
const yxml = store.getXml();
```

#### [getValue](/api-reference/sdk/api/api-methods#getvalue)

Get the current store value.

- Returns: `T`

```ts
const value = store.getValue();
```

#### [update](/api-reference/sdk/api/api-methods#update)

Update the store value and sync to peers.

- Params: `newValue: T`
- Returns: `void`

```ts
store.update('New Value');
```

#### [subscribe](/api-reference/sdk/api/api-methods#subscribe)

Subscribe to changes in the store.

- Params: `(newValue: T) => void`
- Returns: `() => void` (unsubscribe)

```ts
const unsubscribe = store.subscribe(console.log);
```

#### [saveVersion](/api-reference/sdk/api/api-methods#saveversion)

Save a snapshot of the current state as a named version.

- Params: `versionName: string`
- Returns: `Promise<string>` (versionId)

```ts
const versionId = await store.saveVersion('Initial checkpoint');
```

#### [getVersions](/api-reference/sdk/api/api-methods#getversions)

Fetch all saved versions.

- Returns: `Promise<Version[]>`

```ts
const versions = await store.getVersions();
```

#### [getVersionById](/api-reference/sdk/api/api-methods#getversionbyid)

Fetch a specific version by ID.

- Params: `versionId: string`
- Returns: `Promise<Version | null>`

```ts
const version = await store.getVersionById('abc123');
```

#### [setStateFromVersion](/api-reference/sdk/api/api-methods#setstatefromversion)

Restore the store state from a specific version object.

- Params: `version: Version`
- Returns: `Promise<void>`

```ts
await store.setStateFromVersion(version);
```

#### [destroy](/api-reference/sdk/api/api-methods#destroy)

Destroy the store, cleaning up resources and listeners.

- Returns: `void`

```ts
store.destroy();
```

</Tab>
</Tabs>

## Encryption

You can encrypt CRDT data before itâ€™s stored in Velt by registering a custom encryption provider. For CRDT methods, input data is of type `Uint8Array | number[]`.

<Tabs>
<Tab title="React / Next.js">

```ts
async function encryptData(config: EncryptConfig<number[]>): Promise<string> {
  const encryptedData = await yourEncryptDataMethod(config.data);
  return encryptedData;
}

async function decryptData(config: DecryptConfig<string>): Promise<number[]> {
  const decryptedData = await yourDecryptDataMethod(config.data);
  return decryptedData;
}

const encryptionProvider: VeltEncryptionProvider<number[], string> = {
  encrypt: encryptData,
  decrypt: decryptData,
};

<VeltProvider
  apiKey="YOUR_API_KEY"
  encryptionProvider={encryptionProvider}
/>

```

</Tab>
<Tab title="Other Frameworks">

```ts
async function encryptData(config: EncryptConfig<number[]>): Promise<string> {
  const encryptedData = await yourEncryptDataMethod(config.data);
  return encryptedData;
}

async function decryptData(config: DecryptConfig<string>): Promise<number[]> {
  const decryptedData = await yourDecryptDataMethod(config.data);
  return decryptedData;
}

const encryptionProvider: VeltEncryptionProvider<number[], string> = {
  encrypt: encryptData,
  decrypt: decryptData,
};

client.setEncryptionProvider(encryptionProvider);
```

</Tab>
</Tabs>

See also: [setEncryptionProvider()](/api-reference/sdk/api/api-methods#setencryptionprovider-encryptionprovider)
 Â· [VeltEncryptionProvider](/api-reference/sdk/models/data-models#veltencryptionprovider)
 Â· [EncryptConfig](/api-reference/sdk/models/data-models#encryptconfig)
 Â· [DecryptConfig](/api-reference/sdk/models/data-models#decryptconfig)