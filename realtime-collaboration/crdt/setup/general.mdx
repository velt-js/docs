---
title: General Purpose
description: Setup CRDT for any framework.
---

## Introduction

Use these guides to add Yjs-based CRDT to your project with Velt. Pick the React Hook wrapper for the fastest integration in React apps, or the core library for other frameworks and vanilla setups.

<Tabs>

  <Tab title="React Hook Wrapper (@veltdev/crdt-react)">

  <Steps titleSize="h2">

  <Step title="Install dependencies">
  **npm:**
  ```bash
  npm install @veltdev/crdt-react @veltdev/crdt @veltdev/react
  ```

  **yarn:**
  ```bash
  yarn add @veltdev/crdt-react @veltdev/crdt @veltdev/react
  ```
  </Step>

  <Step title="Initialize Velt in your app">
  Wrap your app with `VeltProvider`. See the full setup in [Install Docs](/get-started/setup/install).

  ```jsx
  import { VeltProvider } from '@veltdev/react';

  export function Root() {
    return (
      <VeltProvider apiKey="YOUR_API_KEY">
        <App />
      </VeltProvider>
    );
  }
  ```
  </Step>

  <Step title="Use the hook to create and sync a CRDT store">
  This example uses a `text` store and wires it to a `<textarea/>`.

  ```jsx
  import React from 'react';
  import { useVeltCrdtStore } from '@veltdev/crdt-react';

  const CollaborativeNote: React.FC = () => {
    const {
      value,
      update,
      saveVersion,
      getVersions,
      getVersionById,
      setStateFromVersion,
    } = useVeltCrdtStore<string>({
      id: 'my-collab-note',
      type: 'text',
      initialValue: 'Hello, world!',
      debounceMs: 100,
    });

    const onSaveVersion = async () => {
      const versionId = await saveVersion('Checkpoint');
      console.log('Saved version:', versionId);
    };

    const onRestoreLatest = async () => {
      const versions = await getVersions();
      if (versions.length === 0) return;
      const latest = versions[0];
      await setStateFromVersion(latest);
    };

    return (
      <div>
        <h3>Collaborative Note</h3>
        <textarea
          value={value ?? ''}
          onChange={(e) => update(e.target.value)}
          rows={8}
          style={{ width: '100%' }}
        />
        <div style={{ marginTop: 8 }}>
          <button onClick={onSaveVersion}>Save Version</button>
          <button onClick={onRestoreLatest} style={{ marginLeft: 8 }}>Restore Latest</button>
        </div>
      </div>
    );
  };

  export default CollaborativeNote;
  ```
  </Step>

  </Steps>

  ### Hook API Summary

  - Requires Velt client initialized via `useVeltClient` from `@veltdev/react`.
  - Generic `<T>` allows typing the store value (e.g., `string` for text, `any[]` for arrays).

  #### Returns
  - `value: T | null` — Current value of the store.
  - `versions: Version[]` — List of all stored versions.
  - `store: Store<T> | null` — The underlying Velt Store instance.
  - `update: (newValue: T) => void` — Updates the store value.
  - `saveVersion: (versionName: string) => Promise<string>` — Saves a new version and returns its ID.
  - `getVersions: () => Promise<Version[]>` — Fetches all versions.
  - `getVersionById: (versionId: string) => Promise<Version | null>` — Fetches a specific version by ID.
  - `restoreVersion: (versionId: string) => Promise<boolean>` — Restores the store to a specific version.
  - `setStateFromVersion: (version: Version) => Promise<void>` — Sets the store state from a version object.

  </Tab>

  <Tab title="Non‑React / Other Frameworks (@veltdev/crdt)">

  <Steps titleSize="h2">

  <Step title="Install dependencies">
  **npm:**
  ```bash
  npm install @veltdev/crdt @veltdev/client
  ```

  **yarn:**
  ```bash
  yarn add @veltdev/crdt @veltdev/client
  ```
  </Step>

  <Step title="Initialize the Velt client">
  For non-React apps, initialize the client directly. For framework-specific steps (Angular, Vue, HTML), see [Install Docs](/get-started/setup/install).

  ```ts
  import { initVelt } from '@veltdev/client';

  // Initialize once in your app bootstrap
  export const client = await initVelt('YOUR_API_KEY');
  ```
  </Step>

  <Step title="Create a CRDT store, subscribe, update, and manage versions">
  A minimal TypeScript example wiring a `text` store:

  ```ts
  import { createVeltStore, Store } from '@veltdev/crdt';
  import { initVelt } from '@veltdev/client';

  async function main() {
    const veltClient = await initVelt('YOUR_API_KEY');

    const store = await createVeltStore<string>({
      id: 'my-document',
      type: 'text', // 'array' | 'map' | 'text' | 'xml'
      initialValue: 'Hello, world!',
      veltClient,
    });

    if (!store) throw new Error('Failed to create store');

    // Listen for changes from local or remote peers
    const unsubscribe = store.subscribe((newValue) => {
      console.log('Updated value:', newValue);
    });

    // Apply a local change (replicates to others)
    store.update('Hello, collaborative world!');

    // Create a named version
    const versionId = await store.saveVersion('Initial checkpoint');
    console.log('Saved version id:', versionId);

    // List and restore
    const versions = await store.getVersions();
    console.log('Versions:', versions.map(v => v.versionName));

    const fetched = await store.getVersionById(versionId);
    if (fetched) {
      await store.setStateFromVersion(fetched);
    }

    // Later: stop listening
    unsubscribe();
  }

  main().catch(console.error);
  ```
  </Step>

  </Steps>

  ### Core API Reference

  #### Exported Functions
  - `createVeltStore<T>(options: CreateVeltStoreOptions<T>): Promise<Store<T> | null>`
    - Creates a new CRDT store instance.
    - Parameters (`CreateVeltStoreOptions<T>`):
      - `id: string` — Unique identifier for the store.
      - `type: string` — Type of the store (e.g., `'array'` for array-based CRDTs, `'object'` for object-based).
      - `initialValue: T` — Optional initial value (e.g., `[]` for an empty array).
      - `veltClient: Velt` — Instance of the Velt client for synchronization.
    - Returns:
      - A Promise resolving to a `Store<T>` instance or `null` if creation fails.

  #### Store Interface
  - `Store<T>`
    - Represents a collaborative data store of type `T` (e.g., `Array<SomeType>`, object, text or xml).
    - Methods:
      - `getValue(): T`
        - Retrieves the current value of the store.
        - Returns: The current state of the data (e.g., an array or object).
        - Usage: Call this to read the latest synchronized value.
      - `update(newValue: T): void`
        - Updates the store with a new value. Changes are propagated to all connected clients via CRDT merging.
        - Parameters: `newValue` — The updated data to set.
        - Returns: `void`.
        - Usage: Use this to apply local changes, which will be replicated automatically. For arrays, this might involve spreading existing items and adding new ones; for objects, merging properties.
      - `subscribe(callback: (newValue: T) => void): () => void`
        - Subscribes to changes in the store's value. The callback is invoked whenever the value updates, either locally or from remote changes.
        - Parameters: `callback` — Function to call with the new value.
        - Returns: An unsubscribe function to stop listening.
        - Usage: Ideal for React's `useEffect` to keep component state in sync with the store.

  #### Version Control Methods
  - `saveVersion(versionName: string): Promise<string>`
    - Creates a snapshot of the current document state as a named version.
    - Parameters: `versionName` — Human-readable name for this version (e.g., "Initial draft", "Final review").
    - Returns: Promise that resolves to the unique version ID string.
    - Usage: Use this to create restore points or milestones in your document's history.
  - `getVersions(): Promise<Version[]>`
    - Retrieves all saved versions of this document, ordered by timestamp (most recent first).
    - Returns: Promise that resolves to an array of `Version` objects.
    - Usage: Use this to display a version history list to users.
  - `getVersionById(versionId: string): Promise<Version | null>`
    - Retrieves a specific version by its unique identifier.
    - Parameters: `versionId` — The unique ID of the version.
    - Returns: Promise that resolves to the `Version` object if found, or `null` if not found.
    - Usage: Use this to get details about a specific version before restoring it.
  - `setStateFromVersion(version: Version): Promise<void>`
    - Updates the document state using data from a specific version object.
    - Parameters: `version` — The `Version` object containing the state to restore.
    - Returns: Promise that resolves when the state has been successfully updated.
    - Usage: To restore specific version state.

  </Tab>

</Tabs>