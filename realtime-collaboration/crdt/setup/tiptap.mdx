---
title: Tiptap Editor
description: Setup CRDT for Tiptap Editor.
---

The @veltdev/tiptap-crdt-react library provides seamless integration between TipTap rich text editor and Velt's collaborative features, enabling real-time collaborative editing with Conflict-free Replicated Data Types (CRDT).

## Prerequisites

- Node.js (v14 or higher)
- React (v16.8 or higher for hooks)
- A Velt account with an API key ([sign up](https://console.velt.dev/))
- Optional: TypeScript for type safety

## Setup

### Step 1: Install Dependencies

First, install the required packages:

<Tabs> 
  <Tab title="React">
    ```bash
    npm install @veltdev/tiptap-crdt-react @tiptap/react @tiptap/starter-kit @tiptap/extension-collaboration @tiptap/extension-collaboration-cursor
    ```
  </Tab> 
  <Tab title="Other Frameworks">
    ```txt
    Coming soon
    ```
  </Tab>
</Tabs>


### Step 2: Setup Velt

Initialize the Velt client by wrapping your app with the `VeltProvider`. This enables authentication and collaboration features. See [Velt Setup Docs](/get-started/setup/install) for details.


### Step 3: Initialize Velt CRDT Store

Use the new useVeltTiptapCrdtExtension hook to wire up CRDT with Tiptap, no manual store plumbing required.

<Tabs> 
  <Tab title="React">
  ```jsx
    const CollaborativeEditor: React.FC = () => {
      const veltTiptapCrdtExtension = useVeltTiptapCrdtExtension({
        editorId: 'YOUR_EDITOR_ID',
      });

      const editor = useEditor(
        {
          extensions: [
            StarterKit.configure({ history: false }),
            ...(veltTiptapCrdtExtension ? [veltTiptapCrdtExtension] : []),
          ],
          content: '',
        },
        [veltTiptapCrdtExtension]
      );

      return (
        <div className="editor-container">
          <div className="editor-content">
            <EditorContent editor={editor} />
          </div>
          <div className="status">
            {veltTiptapCrdtExtension
              ? 'Connected to collaborative session'
              : 'Connecting to collaborative session...'}
          </div>
        </div>
      );
    };

    export default CollaborativeEditor;
  ```
  </Tab>
  <Tab title="Other Frameworks">
    ```txt
    Coming soon
    ```
  </Tab>
</Tabs>

## Notes

- **Unique editorId**: Use a unique `editorId` per editor instance.
- **Disable history**: Turn off TipTap `history` when using collaboration.
- **Initialize and clean up**: Create the VeltTipTap store after auth and destroy it on unmount.
- **Auth required**: Ensure the Velt client is initialized and user is available before starting.

## Testing and Debugging

**To test collaboration:**
1. Open two browser windows with different user sessions.
2. Edit in one window and verify changes and cursors appear in the other.

**Common issues:**
- Cursors not appearing: Ensure each editor has a unique `editorId` and users are authenticated.
- Editor not loading: Confirm the Velt client is initialized and the API key is valid.
- Desynced content: Make sure TipTap `history` is disabled when using collaboration.

## Complete Example

Use two sessions to test real-time collaboration: open this page in your current browser and a second window in Incognito/Private mode (or a different browser). Type in one window and watch changes appear live in the other.

<Tabs>
<Tab title="Complete Code">

See [Velt TipTap Demo Repo](https://github.com/velt-js/velt-tiptap-crdt-demo) for our complete implementation.

```jsx Relevant Code expandable lines
    import { EditorContent, useEditor } from '@tiptap/react';
    import StarterKit from '@tiptap/starter-kit';
    import { useVeltTiptapCrdtExtension } from '@veltdev/tiptap-crdt-react';
    import React from 'react';

    const CollaborativeEditor: React.FC = () => {
      const veltTiptapCrdtExtension = useVeltTiptapCrdtExtension({
        editorId: 'YOUR_EDITOR_ID',
      });

      const editor = useEditor(
        {
          extensions: [
            StarterKit.configure({ history: false }),
            ...(veltTiptapCrdtExtension ? [veltTiptapCrdtExtension] : []),
          ],
          content: '',
        },
        [veltTiptapCrdtExtension]
      );

      return (
        <div className="editor-container">
          <div className="editor-content">
            <EditorContent editor={editor} />
          </div>
          <div className="status">
            {veltTiptapCrdtExtension
              ? 'Connected to collaborative session'
              : 'Connecting to collaborative session...'}
          </div>
        </div>
      );
    };

    export default CollaborativeEditor;
```

</Tab>
<Tab title="Live Demo">

[Open in larger window](https://velt-tiptap-crdt-demo.vercel.app/)

<Frame>
  <iframe
    src="https://velt-tiptap-crdt-demo.vercel.app/"
    className="w-full"
    height="500px"
  ></iframe>
</Frame>

</Tab>
</Tabs>

## Encryption

You can encrypt CRDT data before it’s stored in Velt by registering a custom encryption provider. For CRDT methods, input data is of type `Uint8Array | number[]`.

<Tabs>
<Tab title="React / Next.js">

```ts
async function encryptData(config: EncryptConfig<number[]>): Promise<string> {
  const encryptedData = await yourEncryptDataMethod(config.data);
  return encryptedData;
}

async function decryptData(config: DecryptConfig<string>): Promise<number[]> {
  const decryptedData = await yourDecryptDataMethod(config.data);
  return decryptedData;
}

const encryptionProvider: VeltEncryptionProvider<number[], string> = {
  encrypt: encryptData,
  decrypt: decryptData,
};

<VeltProvider
  apiKey="YOUR_API_KEY"
  encryptionProvider={encryptionProvider}
/>
```

</Tab>
<Tab title="Other Frameworks">

```ts
async function encryptData(config: EncryptConfig<number[]>): Promise<string> {
  const encryptedData = await yourEncryptDataMethod(config.data);
  return encryptedData;
}

async function decryptData(config: DecryptConfig<string>): Promise<number[]> {
  const decryptedData = await yourDecryptDataMethod(config.data);
  return decryptedData;
}

const encryptionProvider: VeltEncryptionProvider<number[], string> = {
  encrypt: encryptData,
  decrypt: decryptData,
};

client.setEncryptionProvider(encryptionProvider);
```

</Tab>
</Tabs>

See also: [setEncryptionProvider()](/api-reference/sdk/api/api-methods#setencryptionprovider-encryptionprovider)
 · [VeltEncryptionProvider](/api-reference/sdk/models/data-models#veltencryptionprovider)
 · [EncryptConfig](/api-reference/sdk/models/data-models#encryptconfig)
 · [DecryptConfig](/api-reference/sdk/models/data-models#decryptconfig)


## APIs

#### [useVeltTiptapCrdtExtension()](/api-reference/sdk/api/api-methods#usevelttiptapcrdtextension)
Provides real-time collaborative TipTap editor functionality with Yjs and Velt SDK synchronization.

- Signature: useVeltTiptapCrdtExtension(config: VeltTiptapCrdtExtensionConfig)
- Params: [VeltTiptapCrdtExtensionConfig](/api-reference/sdk/models/data-models#velttiptapcrdtextensionconfig)
- Returns: Extension | null
- React Hook: `useVeltTiptapCrdtExtension()`

<Tabs>
<Tab title="React / Next.js">
```jsx
const collab = useVeltTiptapCrdtExtension({ editorId: 'my-doc' });
```
</Tab>
</Tabs>

#### [createVeltTipTapStore](/api-reference/sdk/api/api-methods#createvelttiptapstore)

Create and initialize a collaborative TipTap store instance.

- Params: [VeltTipTapStoreConfig](/api-reference/sdk/models/data-models#velttiptapstoreconfig)
- Returns: [VeltTipTapStore](/api-reference/sdk/models/data-models#velttiptapstore)

<Tabs>
<Tab title="React / Next.js">
```jsx
const store = await createVeltTipTapStore({ editorId: 'velt-tiptap-crdt-demo' });
```
</Tab>

<Tab title="Other Frameworks">
```js
const store = await createVeltTipTapStore({ editorId: 'velt-tiptap-crdt-demo' });
```
</Tab>
</Tabs>

#### [initialize()](/api-reference/sdk/api/api-methods#initialize)

Initialize the store and start syncing the collaborative document.

- Returns: void

<Tabs>
<Tab title="React / Next.js">
```jsx
await store.initialize();
```
</Tab>

<Tab title="Other Frameworks">
```js
await store.initialize();
```
</Tab>
</Tabs>

#### [getCollabExtension()](/api-reference/sdk/api/api-methods#getcollabextension)

Get the TipTap collaboration extension bound to the current Yjs document.

- Returns: Extension

<Tabs>
<Tab title="React / Next.js">
```jsx
const collab = store.getCollabExtension();
```
</Tab>

<Tab title="Other Frameworks">
```js
const collab = store.getCollabExtension();
```
</Tab>
</Tabs>


#### [destroy()](/api-reference/sdk/api/api-methods#destroy)

Tear down the store and clean up listeners/resources.

- Returns: void

<Tabs>
<Tab title="React / Next.js">
```jsx
store.destroy();
```
</Tab>

<Tab title="Other Frameworks">
```js
store.destroy();
```
</Tab>
</Tabs>

#### [getStore()](/api-reference/sdk/api/api-methods#getstore)

Access the underlying CRDT store managing document state.

- Returns: Store

<Tabs>
<Tab title="React / Next.js">
```jsx
const crdtStore = store.getStore();
```
</Tab>

<Tab title="Other Frameworks">
```js
const crdtStore = store.getStore();
```
</Tab>
</Tabs>

#### [getYDoc()](/api-reference/sdk/api/api-methods#getydoc)

Accessor for the underlying Yjs document.

- Returns: Y.Doc

```jsx
const ydoc = store.getYDoc();
```


#### [getYXml()](/api-reference/sdk/api/api-methods#getyxml)

Returns the Y.XmlFragment instance that handles TipTap's rich text structure.

- Returns: Y.XmlFragment | null

```jsx
const yxml = store.getYXml();
```