<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tracking Scripts Test</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .test-section {
            background: #2a2a2a;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .success { color: #4ade80; }
        .error { color: #f87171; }
        .info { color: #60a5fa; }
        ul { list-style: none; padding: 0; }
        li { margin-bottom: 8px; padding: 8px; background: #1a1a1a; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>üîç Tracking Scripts Validation</h1>
    <p>Open your browser's Developer Console (F12) to see detailed results.</p>
    
    <div class="test-section">
        <h2>Reb2b Tracking</h2>
        <ul id="reb2b-results"></ul>
    </div>

    <div class="test-section">
        <h2>Signals Tracking</h2>
        <ul id="signals-results"></ul>
    </div>

    <!-- Include the tracking scripts -->
    <script src="./reb2b-tracking.js"></script>
    <script src="./signals-tracking.js"></script>
    
    <!-- Validation script -->
    <script>
        const reb2bResults = document.getElementById('reb2b-results');
        const signalsResults = document.getElementById('signals-results');
        
        function addResult(container, message, type = 'info') {
            const li = document.createElement('li');
            li.innerHTML = message;
            li.className = type;
            container.appendChild(li);
        }

        // Wait for scripts to initialize
        setTimeout(() => {
            console.log('=== üîç Tracking Scripts Validation ===\n');
            
            // ========== Reb2b Validation ==========
            console.log('--- Reb2b Tracking ---');
            
            if (typeof window.reb2b !== 'undefined') {
                addResult(reb2bResults, '‚úì window.reb2b object is defined', 'success');
                console.log('‚úì window.reb2b:', window.reb2b);
                
                if (window.reb2b.loaded) {
                    addResult(reb2bResults, '‚úì Reb2b loaded successfully', 'success');
                }
                
                if (typeof window.reb2b.assignIdentity === 'function') {
                    addResult(reb2bResults, '‚úì assignIdentity() method available', 'success');
                }
                
                if (typeof window.reb2b.collect === 'function') {
                    addResult(reb2bResults, '‚úì collect() method available', 'success');
                }
            } else {
                addResult(reb2bResults, '‚úó window.reb2b NOT defined', 'error');
                console.error('‚úó window.reb2b NOT defined');
            }
            
            // Check for Reb2b script tag
            const scripts = document.getElementsByTagName('script');
            let reb2bScriptFound = false;
            
            for (let script of scripts) {
                if (script.src.includes('b2bjsstore.s3.us-west-2.amazonaws.com')) {
                    reb2bScriptFound = true;
                    addResult(reb2bResults, `‚úì Script injected: ${script.src.substring(0, 60)}...`, 'success');
                    console.log('‚úì Reb2b script URL:', script.src);
                    break;
                }
            }
            
            if (!reb2bScriptFound) {
                addResult(reb2bResults, '‚úó Reb2b script tag NOT found', 'error');
            }
            
            console.log('');
            
            // ========== Signals Validation ==========
            console.log('--- Signals Tracking ---');
            
            if (typeof window.signals !== 'undefined') {
                addResult(signalsResults, '‚úì window.signals object is defined', 'success');
                console.log('‚úì window.signals:', window.signals);
                
                if (typeof window.signals.page === 'function') {
                    addResult(signalsResults, '‚úì signals.page() method available', 'success');
                    console.log('‚úì signals.page() available');
                }
                
                if (typeof window.signals.identify === 'function') {
                    addResult(signalsResults, '‚úì signals.identify() method available', 'success');
                    console.log('‚úì signals.identify() available');
                }
                
                if (typeof window.signals.form === 'function') {
                    addResult(signalsResults, '‚úì signals.form() method available', 'success');
                    console.log('‚úì signals.form() available');
                }
            } else {
                addResult(signalsResults, '‚úó window.signals NOT defined', 'error');
                console.error('‚úó window.signals NOT defined');
            }
            
            // Check for Signals script tag
            let signalsScriptFound = false;
            
            for (let script of scripts) {
                if (script.src.includes('cdn.cr-relay.com')) {
                    signalsScriptFound = true;
                    addResult(signalsResults, `‚úì Script injected: ${script.src.substring(0, 60)}...`, 'success');
                    console.log('‚úì Signals script URL:', script.src);
                    break;
                }
            }
            
            if (!signalsScriptFound) {
                addResult(signalsResults, '‚úó Signals script tag NOT found', 'error');
            }
            
            console.log('');
            console.log('=== üìä Network Tab Instructions ===');
            console.log('Check the Network tab for:');
            console.log('1. Request to b2bjsstore.s3.us-west-2.amazonaws.com (Reb2b)');
            console.log('2. Request to cdn.cr-relay.com (Signals)');
            console.log('Both should show Status 200');
            console.log('=== End Validation ===');
            
            // Add network instructions to page
            addResult(reb2bResults, '‚Ñπ Check Network tab for AWS S3 request', 'info');
            addResult(signalsResults, '‚Ñπ Check Network tab for cr-relay CDN request', 'info');
            
        }, 1000);
    </script>
</body>
</html>
